;-----------------------------------------------
;SET_LCD 
;(1) FUNCTION: Initialize LCD module
;    * FUNCTION SET: DL=0, N=1
;    * DISPLAY ON/OFF: D=1, C=0, B=0
;    * ENTRY MODE SET: I/D=1, S=0      
;(2) INPUT	: None
;(3) OUTPUT	: None
;(4) USE REG.	: R2,R3,R4
;------------------------------------------------  
EXTRN		CODE(WLCD_COMMAND)
EXTRN		CODE(DELAY_01MS)
PUBLIC		SET_LCD
ROM			SEGMENT CODE
RSEG		ROM

LCD_BUS		EQU		P2
LCD_E		EQU		P2.2
LCD_RW		EQU		P2.1
LCD_RS		EQU		P2.0

SET_LCD:
			MOV		R4,#150
			CALL	DELAY_01MS
;(1)
			MOV		R2,#00110100B
			CALL	SET_COMMAND

			MOV		R4,#41
			CALL	DELAY_01MS
;(2)
			MOV		R2,#00111000B
			CALL	SET_COMMAND

			MOV		R4,#10
			CALL	DELAY_01MS
;(3)
			MOV		R2,#00110100B
			CALL	SET_COMMAND
;(4)
			MOV		R2,#00100100B
			CALL	SET_COMMAND
;(5)
			MOV		R2,#00100100B
			CALL	SET_COMMAND
;(6)
			MOV		R2,#10000100B
			CALL	SET_COMMAND
;(7)
			MOV		R2,#00000100B
			CALL	SET_COMMAND
;(8)
			MOV		R2,#10000100B
			CALL	SET_COMMAND
;(9)
			MOV		R2,#00000100B
			CALL	SET_COMMAND
;(10)
			MOV		R2,#00010100B
			CALL	SET_COMMAND
;(11)
			MOV		R2,#00000100B
			CALL	SET_COMMAND
;(12)
			MOV		R2,#01100100B
			CALL	SET_COMMAND
;(13)
			MOV		R2,#00000100B
			CALL	SET_COMMAND
;(14)
			MOV		R2,#11000100B
			CALL	SET_COMMAND
			RET

SET_COMMAND:
			CLR		LCD_RW
			CLR		LCD_RS
			SETB	LCD_E
			MOV		LCD_BUS,R2
			CLR		LCD_E
			SETB	LCD_RS
			SETB	LCD_RW
			MOV		R4,#20
			CALL	DELAY_01MS
			RET
			END
